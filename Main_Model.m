%SEIR MODEL
% use the function ODE45 to calculate differential equations http://uk.mathworks.com/help/matlab/ref/ode45.html
clear all;

%to solve differential equations we need to define initial conditions and time interval
%y1: susceptible, y2= exposed, y3= unexposed, y4= resistant, y5= infected
%susc, y6= infected resistant, y7= dead suscp, y8= dead resistant.
y0=[357 4 4 18 2 1 0 0 ];  %1000000 susceptibles, 10 exposed, 0 infected, 0 recovered.
tspan=[0 100]; %timespan of five years: 365*5

%Beta estimation:
years=1:1:9;
cases=[6.32 12.689 59.639 54.18 65.01 60.54 136.94 108.65 47.52];
mean_y = nanmean(cases);
range_y= range(cases); 
max_y= nanmax(cases);
min_y= nanmin(cases);

%ALGO PASA con grupo de RESISTENCIA VS EL RESTO. TRANSMISSION ES MUY
%RÁPIDA!

%Define the parameters
pop0=22473;
birth= 0.000032;
death= 0.000019;
turnoverhos= 0.000054;
probbact= 0.011;
drugsensmort= 0.2;
drugresimort= 0.6;
betaC = 0.1859; %0.1859 // 7.7710e-05
%betaCS= 0.000;
%betaHos= 0.000;
treatmentrat1= 0.2;
%treatmentrat2= 0.1;
clearance= 0.1;
recovresist= 0.1;
recovsuscep=0.2;
%animalcontac= 0.35;
%householdp= 0.0484659;
enhancmentinf= 0.05;
badtreatinfect= 0.0135;
clearinffect= 0.05;
riskcoeff= 1.27;
exposedprop= 0.518;
density=0.0484659;
%NEW:
antibioticexp= 0.012;
expo_suscep=1; 
passawaytime= 0.1; %1/10
exptime=1;
%clearinff=0.05
%z1=10;
%z1=0
[t,y] = ode45(@(t,y) Diss_equations(t,y,birth, death,recovresist, recovsuscep,treatmentrat1, clearance,probbact,exposedprop,riskcoeff,betaC, badtreatinfect, enhancmentinf, drugresimort, drugsensmort,clearinffect,passawaytime,expo_suscep,antibioticexp,exptime),tspan,y0);
x0=[357 4 4 36 2 1 0 0 ];
clearinffect=clearinffect*10;
[t,x] = ode45(@(t,x) Diss_equations(t,x,birth, death,recovresist, recovsuscep,treatmentrat1, clearance,probbact,exposedprop,riskcoeff,betaC, badtreatinfect, enhancmentinf, drugresimort, drugsensmort,clearinffect,passawaytime,expo_suscep,antibioticexp,exptime),tspan,y0);
z0=[357 4 4 36 2 1 0 0 ];
clearinffect=clearinffect*0.1;
[t,z] = ode45(@(t,z) Diss_equations(t,z,birth, death,recovresist, recovsuscep,treatmentrat1, clearance,probbact,exposedprop,riskcoeff,betaC, badtreatinfect, enhancmentinf, drugresimort, drugsensmort,clearinffect,passawaytime,expo_suscep,antibioticexp,exptime),tspan,y0);


%PLOTS
%figure(01)
%plot(t,y(:,1), 'LineWidth', 2.5, 'color', 'k')
%hold on
%plot(t,y(:,2), 'LineWidth', 2.5, 'color', 'g')
%hold on
%plot(t,y(:,3), 'LineWidth', 2.5, 'color', 'b')
%hold on
%plot(t,y(:,4), 'LineWidth', 2.5, 'color', 'm')
%hold on
%plot(t,y(:,5), 'LineWidth', 2.5, 'color', 'c')
%hold on
%plot(t,y(:,6), 'LineWidth', 2.5, 'color', 'y')
%hold on
%plot(t,y(:,7), 'LineWidth', 2.5, 'color', 'r')
%hold on
%plot(t,y(:,8), '--', 'LineWidth', 2.5, 'color', 'r')
%set(gca, 'FontSize', 16);
%xlabel('Time in days')
%ylabel('Populations')
%title(['S-E-U-R-Ir-Is-Dr-Ds'] )
%legend('Susceptibles', 'Exposed', 'Unexposed','Resistant', 'Susceptible BS infection', 'Resistant BS infection', 'Dead BS Susceptible','Dead BS Resistant')

%Epidemic curves
%figure(02)
%plot(t,y(:,3), '--','LineWidth', 2.5, 'color', 'b')
%set(gca, 'FontSize', 16);
%xlabel('Time')
%ylabel('Populations')
%title(['Number of infections'] )
%legend('Beta=')

%Population
%figure(03)
%plot(t,[(y(:,1)+y(:,2)+y(:,3)+y(:,4)+y(:,5)+y(:,6))], '-','LineWidth', 2.5, 'color', 'r')
%hold on
%plot(t,y(:,8)+y(:,7), '--', 'LineWidth', 2.5, 'color', 'r')
%set(gca, 'FontSize', 16);
%xlabel('Time')
%ylabel('Population')
%title(['Population size over time'] )
%legend('Total population', 'Number of deaths attributed to bloodstream infections')


%t = 1:1:153;
%t= t(:);
figure(1)
plot(t,y(:,1)+y(:,2)+y(:,3), 'LineWidth', 2.5, 'color', 'k')
hold on
plot(t,y(:,4), 'LineWidth', 2.5, 'color', 'm')
hold on
plot(t,y(:,5)+y(:,6), 'LineWidth', 2.5, 'color', 'c')
hold on
plot(t,y(:,7), 'LineWidth', 2.5, 'color', 'r')
hold on
plot(t,y(:,8), '--', 'LineWidth', 2.5, 'color', 'r')
set(gca, 'FontSize', 16);
xlabel('Time in days')
ylabel('Number of cases')
title([''] )
legend('Susceptibles+Exposed+Unexposed','Resistant', 'BS Infection', 'Dead BS Susceptible','Dead BS Resistant')





%p=[1 1.781 0.979 0.216 0.017  0.00000010082 -0.0000000000041234 1 5];
%r = roots(p)
%z1=0.9588
%(z1^8 + z1^7*(badtreatinfect - birth + clearance + clearinffect + 6*death + enhancmentinf + expo_suscep + probbact + recovsuscep + recovresist + treatmentrat1 - clearance*probbact - badtreatinfect*recovsuscep + drugresimort*passawaytime + drugsensmort*passawaytime - clearinffect*recovresist - enhancmentinf*recovresist - drugsensmort*passawaytime*recovsuscep - drugresimort*passawaytime*recovresist) + z1^6*(- badtreatinfect*birth + badtreatinfect*clearance + badtreatinfect*clearinffect - birth*clearance - birth*clearinffect + 5*badtreatinfect*death - 5*birth*death + clearance*clearinffect + 5*clearance*death + 5*clearinffect*death - birth*enhancmentinf + badtreatinfect*expo_suscep - birth*expo_suscep + clearance*enhancmentinf + clearance*expo_suscep + clearinffect*expo_suscep + 5*death*enhancmentinf + 5*death*expo_suscep + enhancmentinf*expo_suscep + badtreatinfect*probbact - birth*probbact + badtreatinfect*recovresist - birth*recovsuscep - birth*recovresist + 5*death*probbact + clearance*recovsuscep + clearance*recovresist + clearinffect*recovsuscep + enhancmentinf*probbact + expo_suscep*probbact + 5*death*recovsuscep + 5*death*recovresist + badtreatinfect*treatmentrat1 - birth*treatmentrat1 + enhancmentinf*recovsuscep + expo_suscep*recovsuscep + expo_suscep*recovresist + clearinffect*treatmentrat1 + 5*death*treatmentrat1 + enhancmentinf*treatmentrat1 + expo_suscep*treatmentrat1 + probbact*recovsuscep + probbact*recovresist + recovsuscep*recovresist + recovsuscep*treatmentrat1 + recovresist*treatmentrat1 + 15*death^2 - badtreatinfect*clearance*probbact + birth*clearance*probbact + badtreatinfect*birth*recovsuscep + badtreatinfect*drugresimort*passawaytime - birth*drugresimort*passawaytime - birth*drugsensmort*passawaytime - badtreatinfect*clearance*recovsuscep - badtreatinfect*clearinffect*recovsuscep - badtreatinfect*clearinffect*recovresist + birth*clearinffect*recovresist + clearance*drugresimort*passawaytime + clearance*drugsensmort*passawaytime + clearinffect*drugsensmort*passawaytime - 5*clearance*death*probbact - 5*badtreatinfect*death*recovsuscep + 5*death*drugresimort*passawaytime + 5*death*drugsensmort*passawaytime - clearance*clearinffect*recovresist - clearance*enhancmentinf*probbact - clearance*expo_suscep*probbact - 5*clearinffect*death*recovresist + birth*enhancmentinf*recovresist - badtreatinfect*expo_suscep*recovsuscep + drugsensmort*enhancmentinf*passawaytime + drugresimort*expo_suscep*passawaytime + drugsensmort*expo_suscep*passawaytime - clearance*enhancmentinf*recovresist - clearinffect*expo_suscep*recovresist - 5*death*enhancmentinf*recovresist - enhancmentinf*expo_suscep*recovresist - badtreatinfect*probbact*recovsuscep + drugresimort*passawaytime*probbact + drugsensmort*passawaytime*probbact - clearance*probbact*recovsuscep - clearance*probbact*recovresist - badtreatinfect*recovsuscep*recovresist + drugresimort*passawaytime*recovsuscep + drugsensmort*passawaytime*recovresist - clearinffect*recovsuscep*recovresist - enhancmentinf*probbact*recovresist - expo_suscep*probbact*recovsuscep - badtreatinfect*recovsuscep*treatmentrat1 + drugresimort*passawaytime*treatmentrat1 + drugsensmort*passawaytime*treatmentrat1 - enhancmentinf*recovsuscep*recovresist - clearinffect*recovresist*treatmentrat1 - enhancmentinf*recovresist*treatmentrat1 + drugresimort*drugsensmort*passawaytime^2 + badtreatinfect*clearance*probbact*recovsuscep - clearance*drugresimort*passawaytime*probbact - clearance*drugsensmort*passawaytime*probbact - badtreatinfect*drugresimort*passawaytime*recovsuscep - badtreatinfect*drugresimort*passawaytime*recovresist + birth*drugsensmort*passawaytime*recovsuscep + birth*drugresimort*passawaytime*recovresist + badtreatinfect*clearinffect*recovsuscep*recovresist - clearance*drugsensmort*passawaytime*recovsuscep - clearance*drugresimort*passawaytime*recovresist - clearinffect*drugsensmort*passawaytime*recovsuscep - clearinffect*drugsensmort*passawaytime*recovresist - 5*death*drugsensmort*passawaytime*recovsuscep - 5*death*drugresimort*passawaytime*recovresist + clearance*enhancmentinf*probbact*recovresist - drugsensmort*enhancmentinf*passawaytime*recovsuscep - drugsensmort*enhancmentinf*passawaytime*recovresist - drugsensmort*expo_suscep*passawaytime*recovsuscep - drugresimort*expo_suscep*passawaytime*recovresist - drugsensmort*passawaytime*probbact*recovsuscep - drugresimort*passawaytime*probbact*recovresist - drugresimort*passawaytime*recovsuscep*recovresist - drugsensmort*passawaytime*recovsuscep*recovresist - drugsensmort*passawaytime*recovsuscep*treatmentrat1 - drugresimort*passawaytime*recovresist*treatmentrat1 - drugresimort*drugsensmort*passawaytime^2*recovsuscep - drugresimort*drugsensmort*passawaytime^2*recovresist + clearance*drugsensmort*passawaytime*probbact*recovsuscep + clearance*drugresimort*passawaytime*probbact*recovresist + badtreatinfect*drugresimort*passawaytime*recovsuscep*recovresist + clearinffect*drugsensmort*passawaytime*recovsuscep*recovresist + drugsensmort*enhancmentinf*passawaytime*recovsuscep*recovresist + drugresimort*drugsensmort*passawaytime^2*recovsuscep*recovresist) + z1^5*(10*badtreatinfect*death^2 - 10*birth*death^2 + 10*clearance*death^2 + 10*clearinffect*death^2 + 10*death^2*enhancmentinf + 10*death^2*expo_suscep + 10*death^2*probbact + 10*death^2*recovsuscep + 10*death^2*recovresist + 10*death^2*treatmentrat1 + 20*death^3 - expo_suscep*probbact^2*recovsuscep - badtreatinfect*birth*clearance - badtreatinfect*birth*clearinffect - 4*badtreatinfect*birth*death + badtreatinfect*clearance*clearinffect - birth*clearance*clearinffect + 4*badtreatinfect*clearance*death + 4*badtreatinfect*clearinffect*death - 4*birth*clearance*death - 4*birth*clearinffect*death - badtreatinfect*birth*expo_suscep + 4*clearance*clearinffect*death - birth*clearance*enhancmentinf + badtreatinfect*clearance*expo_suscep + badtreatinfect*clearinffect*expo_suscep - birth*clearance*expo_suscep - birth*clearinffect*expo_suscep - 4*birth*death*enhancmentinf + 4*badtreatinfect*death*expo_suscep - 4*birth*death*expo_suscep + clearance*clearinffect*expo_suscep + 4*clearance*death*enhancmentinf + 4*clearance*death*expo_suscep + 4*clearinffect*death*expo_suscep - birth*enhancmentinf*expo_suscep + clearance*enhancmentinf*expo_suscep + 4*death*enhancmentinf*expo_suscep - badtreatinfect*birth*probbact - badtreatinfect*birth*recovresist + 4*badtreatinfect*death*probbact - 4*birth*death*probbact + badtreatinfect*clearance*recovresist - birth*clearance*recovsuscep - birth*clearance*recovresist - birth*clearinffect*recovsuscep - birth*enhancmentinf*probbact + badtreatinfect*expo_suscep*probbact - birth*expo_suscep*probbact + 4*badtreatinfect*death*recovresist - 4*birth*death*recovsuscep - 4*birth*death*recovresist - badtreatinfect*birth*treatmentrat1 + clearance*clearinffect*recovsuscep + 4*clearance*death*recovsuscep + 4*clearance*death*recovresist + 4*clearinffect*death*recovsuscep - birth*enhancmentinf*recovsuscep + badtreatinfect*expo_suscep*recovresist + badtreatinfect*clearinffect*treatmentrat1 + 4*death*enhancmentinf*probbact - birth*expo_suscep*recovsuscep - birth*expo_suscep*recovresist - birth*clearinffect*treatmentrat1 + 4*death*expo_suscep*probbact + 4*badtreatinfect*death*treatmentrat1 + clearance*enhancmentinf*recovsuscep - 4*birth*death*treatmentrat1 + clearance*expo_suscep*recovsuscep + clearance*expo_suscep*recovresist + clearinffect*expo_suscep*recovsuscep + enhancmentinf*expo_suscep*probbact + 4*death*enhancmentinf*recovsuscep + 4*death*expo_suscep*recovsuscep + 4*death*expo_suscep*recovresist + 4*clearinffect*death*treatmentrat1 - birth*enhancmentinf*treatmentrat1 + badtreatinfect*expo_suscep*treatmentrat1 - birth*expo_suscep*treatmentrat1 + enhancmentinf*expo_suscep*recovsuscep + clearinffect*expo_suscep*treatmentrat1 + 4*death*enhancmentinf*treatmentrat1 + 4*death*expo_suscep*treatmentrat1 + enhancmentinf*expo_suscep*treatmentrat1 + badtreatinfect*probbact*recovresist - birth*probbact*recovsuscep - birth*probbact*recovresist - birth*recovsuscep*recovresist + 4*death*probbact*recovsuscep + 4*death*probbact*recovresist + clearance*recovsuscep*recovresist + enhancmentinf*probbact*recovsuscep + expo_suscep*probbact*recovsuscep + expo_suscep*probbact*recovresist + 4*death*recovsuscep*recovresist + badtreatinfect*recovresist*treatmentrat1 - birth*recovsuscep*treatmentrat1 - birth*recovresist*treatmentrat1 + expo_suscep*recovsuscep*recovresist + clearinffect*recovsuscep*treatmentrat1 + 4*death*recovsuscep*treatmentrat1 + 4*death*recovresist*treatmentrat1 + enhancmentinf*recovsuscep*treatmentrat1 + expo_suscep*recovsuscep*treatmentrat1 + expo_suscep*recovresist*treatmentrat1 + probbact*recovsuscep*recovresist + recovsuscep*recovresist*treatmentrat1 - 10*clearance*death^2*probbact - 10*badtreatinfect*death^2*recovsuscep + 10*death^2*drugresimort*passawaytime + 10*death^2*drugsensmort*passawaytime - 10*clearinffect*death^2*recovresist - 10*death^2*enhancmentinf*recovresist - clearance*enhancmentinf*expo_suscep*recovresist - 4*death*enhancmentinf*expo_suscep*recovresist + badtreatinfect*birth*probbact*recovsuscep + badtreatinfect*drugresimort*passawaytime*probbact - birth*drugresimort*passawaytime*probbact - birth*drugsensmort*passawaytime*probbact - badtreatinfect*clearance*probbact*recovresist + birth*clearance*probbact*recovsuscep + birth*clearance*probbact*recovresist + badtreatinfect*birth*recovsuscep*recovresist - 4*badtreatinfect*death*probbact*recovsuscep - birth*drugresimort*passawaytime*recovsuscep - birth*drugsensmort*passawaytime*recovresist + 4*death*drugresimort*passawaytime*probbact + 4*death*drugsensmort*passawaytime*probbact - badtreatinfect*clearance*recovsuscep*recovresist + birth*clearinffect*recovsuscep*recovresist + clearance*drugresimort*passawaytime*recovsuscep + clearance*drugsensmort*passawaytime*recovresist - 4*clearance*death*probbact*recovsuscep - 4*clearance*death*probbact*recovresist + birth*enhancmentinf*probbact*recovresist - badtreatinfect*expo_suscep*probbact*recovsuscep - badtreatinfect*expo_suscep*probbact*recovresist + drugsensmort*enhancmentinf*passawaytime*probbact + birth*expo_suscep*probbact*recovsuscep + drugresimort*expo_suscep*passawaytime*probbact + drugsensmort*expo_suscep*passawaytime*probbact - 4*badtreatinfect*death*recovsuscep*recovresist + 4*death*drugresimort*passawaytime*recovsuscep + 4*death*drugsensmort*passawaytime*recovresist + badtreatinfect*birth*recovsuscep*treatmentrat1 - clearance*clearinffect*recovsuscep*recovresist + badtreatinfect*drugresimort*passawaytime*treatmentrat1 - birth*drugresimort*passawaytime*treatmentrat1 - birth*drugsensmort*passawaytime*treatmentrat1 - clearance*enhancmentinf*probbact*recovsuscep - 2*clearance*expo_suscep*probbact*recovsuscep - clearance*expo_suscep*probbact*recovresist - clearinffect*expo_suscep*probbact*recovsuscep - 4*clearinffect*death*recovsuscep*recovresist + birth*enhancmentinf*recovsuscep*recovresist - badtreatinfect*expo_suscep*recovsuscep*recovresist - badtreatinfect*clearinffect*recovsuscep*treatmentrat1 - badtreatinfect*clearinffect*recovresist*treatmentrat1 - 4*death*enhancmentinf*probbact*recovresist + birth*clearinffect*recovresist*treatmentrat1 + drugresimort*expo_suscep*passawaytime*recovsuscep + drugsensmort*expo_suscep*passawaytime*recovresist + clearinffect*drugsensmort*passawaytime*treatmentrat1 - 4*death*expo_suscep*probbact*recovsuscep - 4*badtreatinfect*death*recovsuscep*treatmentrat1 - clearance*enhancmentinf*recovsuscep*recovresist + 4*death*drugresimort*passawaytime*treatmentrat1 + 4*death*drugsensmort*passawaytime*treatmentrat1 - clearinffect*expo_suscep*recovsuscep*recovresist - enhancmentinf*expo_suscep*probbact*recovsuscep - enhancmentinf*expo_suscep*probbact*recovresist - 4*death*enhancmentinf*recovsuscep*recovresist - 4*clearinffect*death*recovresist*treatmentrat1 + birth*enhancmentinf*recovresist*treatmentrat1 - badtreatinfect*expo_suscep*recovsuscep*treatmentrat1 + drugsensmort*enhancmentinf*passawaytime*treatmentrat1 + drugresimort*expo_suscep*passawaytime*treatmentrat1 + drugsensmort*expo_suscep*passawaytime*treatmentrat1 - enhancmentinf*expo_suscep*recovsuscep*recovresist - clearinffect*expo_suscep*recovresist*treatmentrat1 - 4*death*enhancmentinf*recovresist*treatmentrat1 - enhancmentinf*expo_suscep*recovresist*treatmentrat1 - badtreatinfect*probbact*recovsuscep*recovresist + drugresimort*passawaytime*probbact*recovsuscep + drugsensmort*passawaytime*probbact*recovresist - clearance*probbact*recovsuscep*recovresist - enhancmentinf*probbact*recovsuscep*recovresist - expo_suscep*probbact*recovsuscep*recovresist - badtreatinfect*recovsuscep*recovresist*treatmentrat1 + drugresimort*passawaytime*recovsuscep*treatmentrat1 + drugsensmort*passawaytime*recovresist*treatmentrat1 - clearinffect*recovsuscep*recovresist*treatmentrat1 - expo_suscep*probbact*recovsuscep*treatmentrat1 - enhancmentinf*recovsuscep*recovresist*treatmentrat1 - birth*drugresimort*drugsensmort*passawaytime^2 + clearance*drugresimort*drugsensmort*passawaytime^2 + 4*death*drugresimort*drugsensmort*passawaytime^2 + drugresimort*drugsensmort*expo_suscep*passawaytime^2 + drugresimort*drugsensmort*passawaytime^2*probbact - 10*death^2*drugsensmort*passawaytime*recovsuscep - 10*death^2*drugresimort*passawaytime*recovresist + clearance*expo_suscep*probbact^2*recovsuscep + drugresimort*drugsensmort*passawaytime^2*treatmentrat1 + badtreatinfect*birth*clearance*probbact - badtreatinfect*birth*drugresimort*passawaytime + badtreatinfect*birth*clearance*recovsuscep + badtreatinfect*birth*clearinffect*recovsuscep + badtreatinfect*birth*clearinffect*recovresist + badtreatinfect*clearance*drugresimort*passawaytime - 4*badtreatinfect*clearance*death*probbact - birth*clearance*drugresimort*passawaytime - birth*clearance*drugsensmort*passawaytime - birth*clearinffect*drugsensmort*passawaytime + 4*birth*clearance*death*probbact + 4*badtreatinfect*birth*death*recovsuscep + 4*badtreatinfect*death*drugresimort*passawaytime - badtreatinfect*clearance*clearinffect*recovsuscep - badtreatinfect*clearance*clearinffect*recovresist - 4*birth*death*drugresimort*passawaytime - 4*birth*death*drugsensmort*passawaytime + birth*clearance*clearinffect*recovresist + clearance*clearinffect*drugsensmort*passawaytime + birth*clearance*enhancmentinf*probbact - badtreatinfect*clearance*expo_suscep*probbact + birth*clearance*expo_suscep*probbact - 4*badtreatinfect*clearance*death*recovsuscep - 4*badtreatinfect*clearinffect*death*recovsuscep - 4*badtreatinfect*clearinffect*death*recovresist + 4*birth*clearinffect*death*recovresist + 4*clearance*death*drugresimort*passawaytime + 4*clearance*death*drugsensmort*passawaytime + 4*clearinffect*death*drugsensmort*passawaytime + badtreatinfect*birth*expo_suscep*recovsuscep - birth*drugsensmort*enhancmentinf*passawaytime + badtreatinfect*drugresimort*expo_suscep*passawaytime - birth*drugresimort*expo_suscep*passawaytime - birth*drugsensmort*expo_suscep*passawaytime - 4*clearance*clearinffect*death*recovresist + birth*clearance*enhancmentinf*recovresist - badtreatinfect*clearance*expo_suscep*recovsuscep - badtreatinfect*clearinffect*expo_suscep*recovsuscep - badtreatinfect*clearinffect*expo_suscep*recovresist + clearance*drugsensmort*enhancmentinf*passawaytime - 4*clearance*death*enhancmentinf*probbact + birth*clearinffect*expo_suscep*recovresist + clearance*drugresimort*expo_suscep*passawaytime + clearance*drugsensmort*expo_suscep*passawaytime + clearinffect*drugsensmort*expo_suscep*passawaytime - 4*clearance*death*expo_suscep*probbact + 4*birth*death*enhancmentinf*recovresist - 4*badtreatinfect*death*expo_suscep*recovsuscep + 4*death*drugsensmort*enhancmentinf*passawaytime + 4*death*drugresimort*expo_suscep*passawaytime + 4*death*drugsensmort*expo_suscep*passawaytime - clearance*clearinffect*expo_suscep*recovresist - clearance*enhancmentinf*expo_suscep*probbact - 4*clearance*death*enhancmentinf*recovresist - 4*clearinffect*death*expo_suscep*recovresist + birth*enhancmentinf*expo_suscep*recovresist + drugsensmort*enhancmentinf*expo_suscep*passawaytime - badtreatinfect*birth*clearance*probbact*recovsuscep - badtreatinfect*clearance*drugresimort*passawaytime*probbact + birth*clearance*drugresimort*passawaytime*probbact + birth*clearance*drugsensmort*passawaytime*probbact + badtreatinfect*birth*drugresimort*passawaytime*recovsuscep + badtreatinfect*birth*drugresimort*passawaytime*recovresist - badtreatinfect*birth*clearinffect*recovsuscep*recovresist - badtreatinfect*clearance*drugresimort*passawaytime*recovsuscep - badtreatinfect*clearance*drugresimort*passawaytime*recovresist + 4*badtreatinfect*clearance*death*probbact*recovsuscep + birth*clearance*drugsensmort*passawaytime*recovsuscep + birth*clearance*drugresimort*passawaytime*recovresist + birth*clearinffect*drugsensmort*passawaytime*recovsuscep + birth*clearinffect*drugsensmort*passawaytime*recovresist - 4*clearance*death*drugresimort*passawaytime*probbact - 4*clearance*death*drugsensmort*passawaytime*probbact + birth*drugsensmort*expo_suscep*passawaytime*probbact - 4*badtreatinfect*death*drugresimort*passawaytime*recovsuscep - 4*badtreatinfect*death*drugresimort*passawaytime*recovresist + badtreatinfect*clearance*clearinffect*recovsuscep*recovresist + 4*birth*death*drugsensmort*passawaytime*recovsuscep + 4*birth*death*drugresimort*passawaytime*recovresist - clearance*clearinffect*drugsensmort*passawaytime*recovsuscep - clearance*clearinffect*drugsensmort*passawaytime*recovresist - birth*clearance*enhancmentinf*probbact*recovresist + badtreatinfect*clearance*expo_suscep*probbact*recovsuscep - clearance*drugsensmort*enhancmentinf*passawaytime*probbact - clearance*drugresimort*expo_suscep*passawaytime*probbact - clearance*drugsensmort*expo_suscep*passawaytime*probbact + 4*badtreatinfect*clearinffect*death*recovsuscep*recovresist - 4*clearance*death*drugsensmort*passawaytime*recovsuscep - 4*clearance*death*drugresimort*passawaytime*recovresist - 4*clearinffect*death*drugsensmort*passawaytime*recovsuscep - 4*clearinffect*death*drugsensmort*passawaytime*recovresist + birth*drugsensmort*enhancmentinf*passawaytime*recovsuscep + birth*drugsensmort*enhancmentinf*passawaytime*recovresist - badtreatinfect*drugresimort*expo_suscep*passawaytime*recovsuscep - badtreatinfect*drugresimort*expo_suscep*passawaytime*recovresist + birth*drugsensmort*expo_suscep*passawaytime*recovsuscep + birth*drugresimort*expo_suscep*passawaytime*recovresist + badtreatinfect*clearinffect*expo_suscep*recovsuscep*recovresist - clearance*drugsensmort*enhancmentinf*passawaytime*recovsuscep - clearance*drugsensmort*enhancmentinf*passawaytime*recovresist + 4*clearance*death*enhancmentinf*probbact*recovresist - clearance*drugsensmort*expo_suscep*passawaytime*recovsuscep - clearance*drugresimort*expo_suscep*passawaytime*recovresist - clearinffect*drugsensmort*expo_suscep*passawaytime*recovsuscep - clearinffect*drugsensmort*expo_suscep*passawaytime*recovresist - 4*death*drugsensmort*enhancmentinf*passawaytime*recovsuscep - 4*death*drugsensmort*enhancmentinf*passawaytime*recovresist - 4*death*drugsensmort*expo_suscep*passawaytime*recovsuscep - 4*death*drugresimort*expo_suscep*passawaytime*recovresist + clearance*enhancmentinf*expo_suscep*probbact*recovresist - drugsensmort*enhancmentinf*expo_suscep*passawaytime*recovsuscep - drugsensmort*enhancmentinf*expo_suscep*passawaytime*recovresist - badtreatinfect*drugresimort*passawaytime*probbact*recovsuscep - badtreatinfect*drugresimort*passawaytime*probbact*recovresist + birth*drugsensmort*passawaytime*probbact*recovsuscep + birth*drugresimort*passawaytime*probbact*recovresist + badtreatinfect*clearance*probbact*recovsuscep*recovresist - clearance*drugresimort*passawaytime*probbact*recovsuscep - clearance*drugsensmort*passawaytime*probbact*recovresist + birth*drugresimort*passawaytime*recovsuscep*recovresist + birth*drugsensmort*passawaytime*recovsuscep*recovresist - 4*death*drugsensmort*passawaytime*probbact*recovsuscep - 4*death*drugresimort*passawaytime*probbact*recovresist - clearance*drugresimort*passawaytime*recovsuscep*recovresist - clearance*drugsensmort*passawaytime*recovsuscep*recovresist + badtreatinfect*expo_suscep*probbact*recovsuscep*recovresist - drugsensmort*enhancmentinf*passawaytime*probbact*recovsuscep - drugsensmort*enhancmentinf*passawaytime*probbact*recovresist - drugresimort*expo_suscep*passawaytime*probbact*recovsuscep - drugsensmort*expo_suscep*passawaytime*probbact*recovsuscep - drugresimort*expo_suscep*passawaytime*probbact*recovresist - 4*death*drugresimort*passawaytime*recovsuscep*recovresist - 4*death*drugsensmort*passawaytime*recovsuscep*recovresist - badtreatinfect*drugresimort*passawaytime*recovsuscep*treatmentrat1 - badtreatinfect*drugresimort*passawaytime*recovresist*treatmentrat1 + birth*drugsensmort*passawaytime*recovsuscep*treatmentrat1 + birth*drugresimort*passawaytime*recovresist*treatmentrat1 + clearance*enhancmentinf*probbact*recovsuscep*recovresist + clearinffect*expo_suscep*probbact*recovsuscep*recovresist + badtreatinfect*clearinffect*recovsuscep*recovresist*treatmentrat1 - drugresimort*expo_suscep*passawaytime*recovsuscep*recovresist - drugsensmort*expo_suscep*passawaytime*recovsuscep*recovresist - clearinffect*drugsensmort*passawaytime*recovsuscep*treatmentrat1 - clearinffect*drugsensmort*passawaytime*recovresist*treatmentrat1 - 4*death*drugsensmort*passawaytime*recovsuscep*treatmentrat1 - 4*death*drugresimort*passawaytime*recovresist*treatmentrat1 + enhancmentinf*expo_suscep*probbact*recovsuscep*recovresist - drugsensmort*enhancmentinf*passawaytime*recovsuscep*treatmentrat1 - drugsensmort*enhancmentinf*passawaytime*recovresist*treatmentrat1 - drugsensmort*expo_suscep*passawaytime*recovsuscep*treatmentrat1 - drugresimort*expo_suscep*passawaytime*recovresist*treatmentrat1 - drugresimort*passawaytime*probbact*recovsuscep*recovresist - drugsensmort*passawaytime*probbact*recovsuscep*recovresist - drugresimort*passawaytime*recovsuscep*recovresist*treatmentrat1 - drugsensmort*passawaytime*recovsuscep*recovresist*treatmentrat1 - clearance*drugresimort*drugsensmort*passawaytime^2*probbact + birth*drugresimort*drugsensmort*passawaytime^2*recovsuscep + birth*drugresimort*drugsensmort*passawaytime^2*recovresist - clearance*drugresimort*drugsensmort*passawaytime^2*recovsuscep - clearance*drugresimort*drugsensmort*passawaytime^2*recovresist - 4*death*drugresimort*drugsensmort*passawaytime^2*recovsuscep - 4*death*drugresimort*drugsensmort*passawaytime^2*recovresist - drugresimort*drugsensmort*expo_suscep*passawaytime^2*recovsuscep - drugresimort*drugsensmort*expo_suscep*passawaytime^2*recovresist - drugresimort*drugsensmort*passawaytime^2*probbact*recovsuscep - drugresimort*drugsensmort*passawaytime^2*probbact*recovresist - drugresimort*drugsensmort*passawaytime^2*recovsuscep*treatmentrat1 - drugresimort*drugsensmort*passawaytime^2*recovresist*treatmentrat1 + clearance*drugresimort*drugsensmort*passawaytime^2*probbact*recovsuscep + clearance*drugresimort*drugsensmort*passawaytime^2*probbact*recovresist - birth*drugresimort*drugsensmort*passawaytime^2*recovsuscep*recovresist + clearance*drugresimort*drugsensmort*passawaytime^2*recovsuscep*recovresist + 4*death*drugresimort*drugsensmort*passawaytime^2*recovsuscep*recovresist + drugresimort*drugsensmort*expo_suscep*passawaytime^2*recovsuscep*recovresist + drugresimort*drugsensmort*passawaytime^2*probbact*recovsuscep*recovresist + drugresimort*drugsensmort*passawaytime^2*recovsuscep*recovresist*treatmentrat1 + badtreatinfect*clearance*drugresimort*passawaytime*probbact*recovsuscep + badtreatinfect*clearance*drugresimort*passawaytime*probbact*recovresist - birth*clearance*drugsensmort*passawaytime*probbact*recovsuscep - birth*clearance*drugresimort*passawaytime*probbact*recovresist - badtreatinfect*birth*drugresimort*passawaytime*recovsuscep*recovresist + badtreatinfect*clearance*drugresimort*passawaytime*recovsuscep*recovresist - birth*clearinffect*drugsensmort*passawaytime*recovsuscep*recovresist + 4*clearance*death*drugsensmort*passawaytime*probbact*recovsuscep + 4*clearance*death*drugresimort*passawaytime*probbact*recovresist - birth*drugsensmort*expo_suscep*passawaytime*probbact*recovsuscep + 4*badtreatinfect*death*drugresimort*passawaytime*recovsuscep*recovresist + clearance*clearinffect*drugsensmort*passawaytime*recovsuscep*recovresist + clearance*drugsensmort*enhancmentinf*passawaytime*probbact*recovsuscep + clearance*drugsensmort*enhancmentinf*passawaytime*probbact*recovresist + clearance*drugsensmort*expo_suscep*passawaytime*probbact*recovsuscep + clearance*drugresimort*expo_suscep*passawaytime*probbact*recovresist + 4*clearinffect*death*drugsensmort*passawaytime*recovsuscep*recovresist - birth*drugsensmort*enhancmentinf*passawaytime*recovsuscep*recovresist + badtreatinfect*drugresimort*expo_suscep*passawaytime*recovsuscep*recovresist + clearance*drugsensmort*enhancmentinf*passawaytime*recovsuscep*recovresist + clearinffect*drugsensmort*expo_suscep*passawaytime*recovsuscep*recovresist + 4*death*drugsensmort*enhancmentinf*passawaytime*recovsuscep*recovresist + drugsensmort*enhancmentinf*expo_suscep*passawaytime*recovsuscep*recovresist + badtreatinfect*drugresimort*passawaytime*probbact*recovsuscep*recovresist + clearance*drugresimort*passawaytime*probbact*recovsuscep*recovresist + clearance*drugsensmort*passawaytime*probbact*recovsuscep*recovresist + drugsensmort*enhancmentinf*passawaytime*probbact*recovsuscep*recovresist + drugresimort*expo_suscep*passawaytime*probbact*recovsuscep*recovresist + badtreatinfect*drugresimort*passawaytime*recovsuscep*recovresist*treatmentrat1 + clearinffect*drugsensmort*passawaytime*recovsuscep*recovresist*treatmentrat1 + drugsensmort*enhancmentinf*passawaytime*recovsuscep*recovresist*treatmentrat1 - badtreatinfect*clearance*drugresimort*passawaytime*probbact*recovsuscep*recovresist - clearance*drugsensmort*enhancmentinf*passawaytime*probbact*recovsuscep*recovresist - clearance*drugresimort*drugsensmort*passawaytime^2*probbact*recovsuscep*recovresist) + z1^4*(10*badtreatinfect*death^3 - 10*birth*death^3 + 10*clearance*death^3 + 10*clearinffect*death^3 + 10*death^3*enhancmentinf + 10*death^3*expo_suscep + 10*death^3*probbact + 10*death^3*recovsuscep + 10*death^3*recovresist + 10*death^3*treatmentrat1 + 15*death^4 + 6*death^2*probbact*recovsuscep + 6*death^2*probbact*recovresist + 6*death^2*recovsuscep*recovresist + 6*death^2*recovsuscep*treatmentrat1 + 6*death^2*recovresist*treatmentrat1 - 6*badtreatinfect*birth*death^2 + 6*badtreatinfect*clearance*death^2 + 6*badtreatinfect*clearinffect*death^2 - 6*birth*clearance*death^2 - 6*birth*clearinffect*death^2 + 6*clearance*clearinffect*death^2 - 6*birth*death^2*enhancmentinf + 6*badtreatinfect*death^2*expo_suscep - 6*birth*death^2*expo_suscep + 6*clearance*death^2*enhancmentinf + 6*clearance*death^2*expo_suscep + 6*clearinffect*death^2*expo_suscep + 6*death^2*enhancmentinf*expo_suscep + 6*badtreatinfect*death^2*probbact - 6*birth*death^2*probbact - 10*clearance*death^3*probbact - 10*badtreatinfect*death^3*recovsuscep + 6*badtreatinfect*death^2*recovresist - 6*birth*death^2*recovsuscep - 6*birth*death^2*recovresist + 10*death^3*drugresimort*passawaytime + 10*death^3*drugsensmort*passawaytime + 6*clearance*death^2*recovsuscep + 6*clearance*death^2*recovresist + 6*clearinffect*death^2*recovsuscep - 10*clearinffect*death^3*recovresist + 6*death^2*enhancmentinf*probbact + 6*death^2*expo_suscep*probbact + 6*badtreatinfect*death^2*treatmentrat1 - 6*birth*death^2*treatmentrat1 + 6*death^2*enhancmentinf*recovsuscep - 10*death^3*enhancmentinf*recovresist + 6*death^2*expo_suscep*recovsuscep + 6*death^2*expo_suscep*recovresist + 6*clearinffect*death^2*treatmentrat1 + 6*death^2*enhancmentinf*treatmentrat1 + 6*death^2*expo_suscep*treatmentrat1 - 3*birth*death*enhancmentinf*treatmentrat1 + 3*badtreatinfect*death*expo_suscep*treatmentrat1 + clearance*enhancmentinf*expo_suscep*recovsuscep - 3*birth*death*expo_suscep*treatmentrat1 + 3*death*enhancmentinf*expo_suscep*recovsuscep + 3*clearinffect*death*expo_suscep*treatmentrat1 - birth*enhancmentinf*expo_suscep*treatmentrat1 + 3*death*enhancmentinf*expo_suscep*treatmentrat1 - badtreatinfect*birth*probbact*recovresist + 3*badtreatinfect*death*probbact*recovresist - 3*birth*death*probbact*recovsuscep - 3*birth*death*probbact*recovresist - birth*clearance*recovsuscep*recovresist - birth*enhancmentinf*probbact*recovsuscep + badtreatinfect*expo_suscep*probbact*recovresist - birth*expo_suscep*probbact*recovsuscep - birth*expo_suscep*probbact*recovresist - 3*birth*death*recovsuscep*recovresist - badtreatinfect*birth*recovresist*treatmentrat1 + 3*clearance*death*recovsuscep*recovresist + 3*death*enhancmentinf*probbact*recovsuscep - birth*expo_suscep*recovsuscep*recovresist - birth*clearinffect*recovsuscep*treatmentrat1 + 3*death*expo_suscep*probbact*recovsuscep + 3*death*expo_suscep*probbact*recovresist + 3*badtreatinfect*death*recovresist*treatmentrat1 - 3*birth*death*recovsuscep*treatmentrat1 - 3*birth*death*recovresist*treatmentrat1 + clearance*expo_suscep*recovsuscep*recovresist + enhancmentinf*expo_suscep*probbact*recovsuscep + 3*death*expo_suscep*recovsuscep*recovresist + 3*clearinffect*death*recovsuscep*treatmentrat1 - birth*enhancmentinf*recovsuscep*treatmentrat1 + badtreatinfect*expo_suscep*recovresist*treatmentrat1 - birth*expo_suscep*recovsuscep*treatmentrat1 - birth*expo_suscep*recovresist*treatmentrat1 + clearinffect*expo_suscep*recovsuscep*treatmentrat1 + 3*death*enhancmentinf*recovsuscep*treatmentrat1 + 3*death*expo_suscep*recovsuscep*treatmentrat1 + 3*death*expo_suscep*recovresist*treatmentrat1 + enhancmentinf*expo_suscep*recovsuscep*treatmentrat1 - birth*probbact*recovsuscep*recovresist + 3*death*probbact*recovsuscep*recovresist + expo_suscep*probbact*recovsuscep*recovresist - birth*recovsuscep*recovresist*treatmentrat1 + 3*death*recovsuscep*recovresist*treatmentrat1 + expo_suscep*recovsuscep*recovresist*treatmentrat1 - 6*badtreatinfect*clearance*death^2*probbact + 6*birth*clearance*death^2*probbact + 6*badtreatinfect*birth*death^2*recovsuscep + 6*badtreatinfect*death^2*drugresimort*passawaytime - 6*birth*death^2*drugresimort*passawaytime - 6*birth*death^2*drugsensmort*passawaytime - 6*badtreatinfect*clearance*death^2*recovsuscep - 6*badtreatinfect*clearinffect*death^2*recovsuscep - 6*badtreatinfect*clearinffect*death^2*recovresist + 6*birth*clearinffect*death^2*recovresist + 6*clearance*death^2*drugresimort*passawaytime + 6*clearance*death^2*drugsensmort*passawaytime + 6*clearinffect*death^2*drugsensmort*passawaytime - 6*clearance*clearinffect*death^2*recovresist - 6*clearance*death^2*enhancmentinf*probbact - 6*clearance*death^2*expo_suscep*probbact + 6*birth*death^2*enhancmentinf*recovresist - 6*badtreatinfect*death^2*expo_suscep*recovsuscep + 6*death^2*drugsensmort*enhancmentinf*passawaytime + 6*death^2*drugresimort*expo_suscep*passawaytime + 6*death^2*drugsensmort*expo_suscep*passawaytime - 6*clearance*death^2*enhancmentinf*recovresist - 6*clearinffect*death^2*expo_suscep*recovresist - 6*death^2*enhancmentinf*expo_suscep*recovresist - 6*badtreatinfect*death^2*probbact*recovsuscep + 6*death^2*drugresimort*passawaytime*probbact + 6*death^2*drugsensmort*passawaytime*probbact - 6*clearance*death^2*probbact*recovsuscep - 6*clearance*death^2*probbact*recovresist - badtreatinfect*expo_suscep*probbact^2*recovresist + birth*expo_suscep*probbact^2*recovsuscep - 6*badtreatinfect*death^2*recovsuscep*recovresist + 6*death^2*drugresimort*passawaytime*recovsuscep - 10*death^3*drugsensmort*passawaytime*recovsuscep - 10*death^3*drugresimort*passawaytime*recovresist + 6*death^2*drugsensmort*passawaytime*recovresist - 6*clearinffect*death^2*recovsuscep*recovresist - 6*death^2*enhancmentinf*probbact*recovresist - 3*death*expo_suscep*probbact^2*recovsuscep - 6*death^2*expo_suscep*probbact*recovsuscep - 6*badtreatinfect*death^2*recovsuscep*treatmentrat1 + 6*death^2*drugresimort*passawaytime*treatmentrat1 + 6*death^2*drugsensmort*passawaytime*treatmentrat1 - enhancmentinf*expo_suscep*probbact^2*recovsuscep - 6*death^2*enhancmentinf*recovsuscep*recovresist - 6*clearinffect*death^2*recovresist*treatmentrat1 - 6*death^2*enhancmentinf*recovresist*treatmentrat1 - expo_suscep*probbact^2*recovsuscep*recovresist + 6*death^2*drugresimort*drugsensmort*passawaytime^2 - badtreatinfect*birth*clearance*clearinffect - 3*badtreatinfect*birth*clearance*death - 3*badtreatinfect*birth*clearinffect*death + 3*badtreatinfect*clearance*clearinffect*death - 3*birth*clearance*clearinffect*death - badtreatinfect*birth*clearance*expo_suscep - badtreatinfect*birth*clearinffect*expo_suscep - 3*badtreatinfect*birth*death*expo_suscep + badtreatinfect*clearance*clearinffect*expo_suscep - birth*clearance*clearinff))
ol=y(:,1)+y(:,2)+y(:,3)+y(:,4)+y(:,5)+y(:,6);
resistance= y(:,4);
rprop= rdivide(resistance, ol);
olprop= rdivide(y(:,1)+y(:,2)+y(:,3), y(:,1)+y(:,2)+y(:,3)+y(:,4)+y(:,5)+y(:,6))

R_n= rdivide(log(olprop)-log(0.5014),olprop-0.5014);
R_n2= rdivide(-log(1-rprop),rprop);
%R_n3_a= rdivide(ol-1, resistance);
%R_n3o=rdivide(1.0014, olprop-0.5);
%R_n3_b=log(R_n3o) ;
%R_n3=R_n3_a*R_n3_b;

